<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoveisBonafe - Admin</title>
    <meta name="description" content="Painel administrativo do MoveisBonafe - Visualização de dados do catálogo.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            line-height: 1.6;
            color: #1f2937;
        }
        
        .header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
        }
        
        .badge {
            background: #6b7280;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-left: 8px;
        }
        
        .btn {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            color: #374151;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .btn:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 24px;
            background: white;
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }
        
        .tab {
            padding: 12px 20px;
            background: #f9fafb;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.2s;
            flex: 1;
            text-align: center;
        }
        
        .tab.active {
            background: white;
            color: #1f2937;
            border-bottom: 2px solid #3b82f6;
        }
        
        .tab:hover:not(.active) {
            background: #f3f4f6;
            color: #374151;
        }
        
        .content {
            background: white;
            border-radius: 0 0 8px 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 4px;
        }
        
        .stat-label {
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }
        
        .data-table th {
            background: #f9fafb;
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
            font-size: 0.9rem;
        }
        
        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.9rem;
        }
        
        .data-table tr:hover {
            background: #f9fafb;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-active {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-inactive {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }
        
        .error {
            background: #fee2e2;
            color: #dc2626;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        
        .price {
            font-weight: 600;
            color: #059669;
        }
        
        .category-color {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 4px;
            margin-right: 8px;
            vertical-align: middle;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 12px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: left;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 16px;
            }
            
            .data-table {
                font-size: 0.8rem;
            }
            
            .data-table th,
            .data-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div>
                <h1>Painel Administrativo<span class="badge">GitHub Pages</span></h1>
            </div>
            <div>
                <a href="index.html" class="btn">← Voltar ao Catálogo</a>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">Visão Geral</button>
            <button class="tab" onclick="showTab('products')">Produtos</button>
            <button class="tab" onclick="showTab('categories')">Categorias</button>
            <button class="tab" onclick="showTab('users')">Usuários</button>
        </div>

        <div class="content">
            <div id="loading" class="loading">
                Carregando dados...
            </div>

            <div id="error" class="error" style="display: none;">
                Erro ao carregar dados. Verifique se os arquivos JSON estão acessíveis.
            </div>

            <!-- Overview Tab -->
            <div id="overview-tab" style="display: none;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-products">-</div>
                        <div class="stat-label">Total de Produtos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="active-products">-</div>
                        <div class="stat-label">Produtos Ativos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-categories">-</div>
                        <div class="stat-label">Categorias</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-users">-</div>
                        <div class="stat-label">Usuários</div>
                    </div>
                </div>

                <h3>Status do Sistema</h3>
                <table class="data-table">
                    <tr>
                        <td><strong>Backend</strong></td>
                        <td>GitHub Pages</td>
                    </tr>
                    <tr>
                        <td><strong>Modo</strong></td>
                        <td>Somente Leitura</td>
                    </tr>
                    <tr>
                        <td><strong>Dados</strong></td>
                        <td>JSON Estático</td>
                    </tr>
                    <tr>
                        <td><strong>Última Atualização</strong></td>
                        <td id="last-update">-</td>
                    </tr>
                </table>
            </div>

            <!-- Products Tab -->
            <div id="products-tab" style="display: none;">
                <h3>Lista de Produtos</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Categoria</th>
                            <th>Preço Base</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="products-table">
                    </tbody>
                </table>
            </div>

            <!-- Categories Tab -->
            <div id="categories-tab" style="display: none;">
                <h3>Lista de Categorias</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Descrição</th>
                            <th>Cor</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="categories-table">
                    </tbody>
                </table>
            </div>

            <!-- Users Tab -->
            <div id="users-tab" style="display: none;">
                <h3>Lista de Usuários</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Username</th>
                            <th>Função</th>
                            <th>Multiplicador</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="users-table">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // GitHub Pages Data Client
        class AdminClient {
            constructor() {
                this.baseUrl = window.location.origin + window.location.pathname.replace('/admin.html', '');
            }

            async loadData(filename) {
                try {
                    const response = await fetch(`${this.baseUrl}/data/${filename}`);
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    return await response.json();
                } catch (error) {
                    console.error(`Erro ao carregar ${filename}:`, error);
                    throw error;
                }
            }

            async getProducts() {
                return await this.loadData('products.json');
            }

            async getCategories() {
                return await this.loadData('categories.json');
            }

            async getUsers() {
                return await this.loadData('users.json');
            }
        }

        // Global variables
        const client = new AdminClient();
        let systemData = {
            products: [],
            categories: [],
            users: []
        };

        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            const tabs = ['overview', 'products', 'categories', 'users'];
            tabs.forEach(tab => {
                document.getElementById(`${tab}-tab`).style.display = 'none';
                document.querySelector(`.tab[onclick="showTab('${tab}')"]`).classList.remove('active');
            });

            // Show selected tab
            document.getElementById(`${tabName}-tab`).style.display = 'block';
            document.querySelector(`.tab[onclick="showTab('${tabName}')"]`).classList.add('active');
        }

        // Initialize application
        async function initAdmin() {
            console.log('🔧 Iniciando painel administrativo');
            
            try {
                // Load all data
                const [products, categories, users] = await Promise.all([
                    client.getProducts(),
                    client.getCategories(),
                    client.getUsers()
                ]);

                systemData.products = products || [];
                systemData.categories = categories || [];
                systemData.users = users || [];

                console.log(`✅ Dados carregados para admin: ${systemData.products.length} produtos, ${systemData.categories.length} categorias, ${systemData.users.length} usuários`);

                // Hide loading, show content
                document.getElementById('loading').style.display = 'none';
                document.getElementById('overview-tab').style.display = 'block';

                // Populate data
                populateOverview();
                populateProductsTable();
                populateCategoriesTable();
                populateUsersTable();

            } catch (error) {
                console.error('❌ Erro no painel admin:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
            }
        }

        function populateOverview() {
            const activeProducts = systemData.products.filter(p => p.active !== false);
            
            document.getElementById('total-products').textContent = systemData.products.length;
            document.getElementById('active-products').textContent = activeProducts.length;
            document.getElementById('total-categories').textContent = systemData.categories.length;
            document.getElementById('total-users').textContent = systemData.users.length;
            document.getElementById('last-update').textContent = new Date().toLocaleString('pt-BR');
        }

        function populateProductsTable() {
            const tbody = document.getElementById('products-table');
            tbody.innerHTML = '';

            systemData.products.forEach(product => {
                const row = tbody.insertRow();
                const price = product.priceAVista || product.basePrice || product.finalPrice || 0;
                const isActive = product.active !== false;
                
                row.innerHTML = `
                    <td>${product.name || 'Sem nome'}</td>
                    <td>${product.category || 'Sem categoria'}</td>
                    <td class="price">R$ ${price.toFixed(2)}</td>
                    <td><span class="status-badge ${isActive ? 'status-active' : 'status-inactive'}">${isActive ? 'Ativo' : 'Inativo'}</span></td>
                `;
            });
        }

        function populateCategoriesTable() {
            const tbody = document.getElementById('categories-table');
            tbody.innerHTML = '';

            systemData.categories.forEach(category => {
                const row = tbody.insertRow();
                const isActive = category.active !== false;
                
                row.innerHTML = `
                    <td>
                        <span class="category-color" style="background-color: ${category.color || '#6b7280'}"></span>
                        ${category.name || 'Sem nome'}
                    </td>
                    <td>${category.description || 'Sem descrição'}</td>
                    <td>${category.color || 'Não definida'}</td>
                    <td><span class="status-badge ${isActive ? 'status-active' : 'status-inactive'}">${isActive ? 'Ativo' : 'Inativo'}</span></td>
                `;
            });
        }

        function populateUsersTable() {
            const tbody = document.getElementById('users-table');
            tbody.innerHTML = '';

            systemData.users.forEach(user => {
                const row = tbody.insertRow();
                const isActive = user.active !== false;
                const multiplier = user.priceMultiplier || 1.0;
                
                row.innerHTML = `
                    <td>${user.name || 'Sem nome'}</td>
                    <td>${user.username || 'Sem username'}</td>
                    <td>${user.role || 'Sem função'}</td>
                    <td>${multiplier.toFixed(2)}x</td>
                    <td><span class="status-badge ${isActive ? 'status-active' : 'status-inactive'}">${isActive ? 'Ativo' : 'Inativo'}</span></td>
                `;
            });
        }

        // Start the application
        document.addEventListener('DOMContentLoaded', initAdmin);
        
        // Log system status
        console.log('📊 MoveisBonafe Admin - GitHub Pages');
        console.log('🔗 Sistema: Somente leitura');
        console.log('💾 Dados: JSON estático');
    </script>
</body>
</html>