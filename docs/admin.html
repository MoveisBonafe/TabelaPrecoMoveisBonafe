<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <meta name="description" content="MoveisBonafe - Painel administrativo completo.">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.5;
        }
        
        .header {
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .admin-badge {
            background: #4a90e2;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .admin-label {
            background: #ff4757;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .logout-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .logout-btn:hover {
            background: #ff3742;
        }
        
        .nav-tabs {
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            padding: 0 20px;
            overflow-x: auto;
        }
        
        .nav-tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            color: #666;
            font-weight: 500;
            font-size: 14px;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .nav-tab:hover {
            color: #4a90e2;
            background: #f8f9fa;
        }
        
        .nav-tab.active {
            color: #4a90e2;
            border-bottom-color: #4a90e2;
            background: #f8f9fa;
        }
        
        .tab-icon {
            font-size: 16px;
        }
        
        .content {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .tab-content {
            display: none;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .content-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .content-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-primary {
            background: #4a90e2;
            color: white;
        }
        
        .btn-primary:hover {
            background: #357abd;
        }
        
        .btn-success {
            background: #5cb85c;
            color: white;
        }
        
        .btn-success:hover {
            background: #449d44;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        .data-table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #555;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: middle;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        .product-image-cell {
            width: 60px;
            height: 60px;
            background: #f5f5f5;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 24px;
        }
        
        .action-buttons-cell {
            display: flex;
            gap: 8px;
        }
        
        .btn-sm {
            padding: 4px 8px;
            font-size: 12px;
        }
        
        .btn-edit {
            background: #f39c12;
            color: white;
        }
        
        .btn-edit:hover {
            background: #e67e22;
        }
        
        .btn-delete {
            background: #e74c3c;
            color: white;
        }
        
        .btn-delete:hover {
            background: #c0392b;
        }
        
        .price-cell {
            font-weight: 600;
            color: #27ae60;
        }
        
        .empty-state {
            padding: 60px 20px;
            text-align: center;
            color: #999;
        }
        
        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: #666;
        }
        
        .loading {
            padding: 60px 20px;
            text-align: center;
            color: #999;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-btn:hover {
            color: #666;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #555;
        }
        
        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
        }
        
        .form-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            background: white;
        }
        
        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 20px;
            padding-top: 16px;
            border-top: 1px solid #e0e0e0;
        }
        
        .btn-cancel {
            background: #6c757d;
            color: white;
        }
        
        .btn-cancel:hover {
            background: #545b62;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 12px;
                align-items: stretch;
            }
            
            .nav-tabs {
                padding: 0 10px;
            }
            
            .nav-tab {
                padding: 8px 12px;
                font-size: 13px;
            }
            
            .content {
                padding: 12px;
            }
            
            .content-header {
                flex-direction: column;
                gap: 12px;
                align-items: stretch;
            }
            
            .data-table {
                font-size: 12px;
            }
            
            .data-table th,
            .data-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <span class="admin-badge">üìã Admin Panel</span>
            <span class="admin-label">Administrador</span>
        </div>
        <button class="logout-btn" onclick="logout()">Sair</button>
    </div>

    <div class="nav-tabs">
        <div class="nav-tab active" onclick="showTab('produtos')" data-tab="produtos">
            <span class="tab-icon">üì¶</span>
            <span>Produtos</span>
        </div>
        <div class="nav-tab" onclick="showTab('categorias')" data-tab="categorias">
            <span class="tab-icon">üè∑Ô∏è</span>
            <span>Categorias</span>
        </div>
        <div class="nav-tab" onclick="showTab('precos')" data-tab="precos">
            <span class="tab-icon">üí∞</span>
            <span>Pre√ßos</span>
        </div>
        <div class="nav-tab" onclick="showTab('usuarios')" data-tab="usuarios">
            <span class="tab-icon">üë•</span>
            <span>Usu√°rios</span>
        </div>
        <div class="nav-tab" onclick="showTab('promocoes')" data-tab="promocoes">
            <span class="tab-icon">üéØ</span>
            <span>Promo√ß√µes</span>
        </div>
        <div class="nav-tab" onclick="showTab('excel')" data-tab="excel">
            <span class="tab-icon">üìä</span>
            <span>Excel</span>
        </div>
        <div class="nav-tab" onclick="showTab('backup')" data-tab="backup">
            <span class="tab-icon">üíæ</span>
            <span>Backup</span>
        </div>
        <div class="nav-tab" onclick="showTab('monitor')" data-tab="monitor">
            <span class="tab-icon">üìà</span>
            <span>Monitor</span>
        </div>
    </div>

    <div class="content">
        <!-- Produtos Tab -->
        <div id="produtos-tab" class="tab-content active">
            <div class="content-header">
                <h2 class="content-title">Gerenciar Produtos</h2>
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="importExcel()">
                        üìä Importar Excel
                    </button>
                    <button class="btn btn-primary" onclick="openProductModal()">
                        ‚ûï Novo Produto
                    </button>
                </div>
            </div>
            <div id="produtos-loading" class="loading">Carregando produtos...</div>
            <div id="produtos-content" style="display: none;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Imagem</th>
                            <th>Produto</th>
                            <th>√Ä Vista</th>
                            <th>30</th>
                            <th>30/60</th>
                            <th>30/60/90</th>
                            <th>30/60/90/120</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="produtos-table">
                    </tbody>
                </table>
                <div id="produtos-empty" class="empty-state" style="display: none;">
                    <h3>Nenhum produto cadastrado</h3>
                    <p>Comece adicionando seu primeiro produto</p>
                </div>
            </div>
        </div>

        <!-- Categorias Tab -->
        <div id="categorias-tab" class="tab-content">
            <div class="content-header">
                <h2 class="content-title">Gerenciar Categorias</h2>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="openCategoryModal()">
                        ‚ûï Nova Categoria
                    </button>
                </div>
            </div>
            <div id="categorias-loading" class="loading">Carregando categorias...</div>
            <div id="categorias-content" style="display: none;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Descri√ß√£o</th>
                            <th>Cor</th>
                            <th>Produtos</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="categorias-table">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pre√ßos Tab -->
        <div id="precos-tab" class="tab-content">
            <div class="content-header">
                <h2 class="content-title">Gerenciar Tabelas de Pre√ßos</h2>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="openPriceModal()">
                        ‚ûï Nova Tabela
                    </button>
                </div>
            </div>
            <div id="precos-loading" class="loading">Carregando tabelas de pre√ßos...</div>
            <div id="precos-content" style="display: none;">
                <h3 style="margin-bottom: 16px; color: #333; font-size: 16px;">Tabelas de Pre√ßos Configuradas</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nome da Tabela</th>
                            <th>Percentual (%)</th>
                            <th>Multiplicador</th>
                            <th>Exemplo (R$ 100)</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="precos-table">
                    </tbody>
                </table>
            </div>
        </div>

        <div id="usuarios-tab" class="tab-content">
            <div class="content-header">
                <h2 class="content-title">Gerenciar Usu√°rios</h2>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="openUserModal()">
                        ‚ûï Novo Usu√°rio
                    </button>
                </div>
            </div>
            <div id="usuarios-loading" class="loading">Carregando usu√°rios...</div>
            <div id="usuarios-content" style="display: none;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Username</th>
                            <th>Fun√ß√£o</th>
                            <th>Multiplicador</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="usuarios-table">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Promo√ß√µes Tab -->
        <div id="promocoes-tab" class="tab-content">
            <div class="content-header">
                <h2 class="content-title">üéØ Gerenciar Promo√ß√µes</h2>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="openPromotionModal()">
                        ‚ûï Nova Promo√ß√£o
                    </button>
                </div>
            </div>
            <div id="promocoes-loading" class="loading">Carregando promo√ß√µes...</div>
            <div id="promocoes-content" style="display: none;">
                <div class="promotion-info" style="background: #e3f2fd; border: 1px solid #2196f3; border-radius: 6px; padding: 16px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <span style="font-size: 16px;">üí°</span>
                        <strong style="color: #1976d2;">Dica:</strong>
                    </div>
                    <p style="color: #1976d2; font-size: 14px; margin: 0;">
                        Apenas uma promo√ß√£o pode estar ativa por vez. Ao ativar uma nova promo√ß√£o, as outras ser√£o automaticamente desativadas.
                    </p>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Texto</th>
                            <th>Descri√ß√£o</th>
                            <th>Cor</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="promocoes-table">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Excel Tab -->
        <div id="excel-tab" class="tab-content">
            <div class="content-header">
                <h2 class="content-title">Importar/Exportar Excel</h2>
            </div>
            <div style="padding: 24px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 32px;">
                    <!-- Import Section -->
                    <div style="background: #f8f9fa; border-radius: 8px; padding: 24px;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
                            <span style="font-size: 20px;">üì•</span>
                            <h3 style="margin: 0; color: #333;">Importar Produtos</h3>
                        </div>
                        <p style="color: #666; margin-bottom: 16px; font-size: 14px;">
                            Importe produtos em massa usando arquivo Excel (.xlsx/.csv)
                        </p>
                        <input type="file" id="excel-upload" accept=".xlsx,.csv" style="display: none;" onchange="handleExcelUpload(event)">
                        <button class="btn btn-success" onclick="document.getElementById('excel-upload').click()">
                            Selecionar Arquivo
                        </button>
                    </div>
                    
                    <!-- Export Section -->
                    <div style="background: #f8f9fa; border-radius: 8px; padding: 24px;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
                            <span style="font-size: 20px;">üì§</span>
                            <h3 style="margin: 0; color: #333;">Exportar Produtos</h3>
                        </div>
                        <p style="color: #666; margin-bottom: 16px; font-size: 14px;">
                            Exporte todos os produtos para arquivo CSV
                        </p>
                        <button class="btn btn-primary" onclick="exportToCSV()">
                            Baixar CSV
                        </button>
                    </div>
                </div>
                
                <!-- Format Guide -->
                <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px;">
                    <h3 style="margin: 0 0 16px 0; color: #333;">Formato de Importa√ß√£o</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Categoria</th>
                                <th>Pre√ßo</th>
                                <th>Altura</th>
                                <th>Largura</th>
                                <th>Comprimento</th>
                                <th>Peso</th>
                                <th>Descri√ß√£o</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Sof√° 3 Lugares</td>
                                <td>Sala de Estar</td>
                                <td>1200.00</td>
                                <td>85</td>
                                <td>200</td>
                                <td>90</td>
                                <td>45.5</td>
                                <td>Sof√° confort√°vel para sala</td>
                            </tr>
                        </tbody>
                    </table>
                    <p style="color: #666; font-size: 13px; margin: 12px 0 0 0;">
                        <strong>Importante:</strong> Use separa√ß√£o por TAB (colunas) para melhor compatibilidade com Excel. Evite acentos nos cabe√ßalhos.
                    </p>
                </div>
            </div>
        </div>

        <!-- Backup Tab -->
        <div id="backup-tab" class="tab-content">
            <div class="content-header">
                <h2 class="content-title">üíæ Backup do Sistema</h2>
            </div>
            <div style="padding: 24px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                    <!-- Backup Section -->
                    <div style="background: #f8f9fa; border-radius: 8px; padding: 24px;">
                        <h3 style="margin: 0 0 16px 0; color: #333;">Fazer Backup</h3>
                        <p style="color: #666; margin-bottom: 16px; font-size: 14px;">
                            Baixe todos os dados do sistema em formato JSON
                        </p>
                        <button class="btn btn-primary" onclick="downloadBackup()">
                            üì• Baixar Backup Completo
                        </button>
                    </div>
                    
                    <!-- Restore Section -->
                    <div style="background: #f8f9fa; border-radius: 8px; padding: 24px;">
                        <h3 style="margin: 0 0 16px 0; color: #333;">Restaurar Backup</h3>
                        <p style="color: #666; margin-bottom: 16px; font-size: 14px;">
                            Restaure dados de um arquivo de backup JSON
                        </p>
                        <input type="file" id="backup-upload" accept=".json" style="display: none;" onchange="handleBackupRestore(event)">
                        <button class="btn btn-success" onclick="document.getElementById('backup-upload').click()">
                            üì§ Selecionar Backup
                        </button>
                    </div>
                </div>
                
                <!-- Backup Info -->
                <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin-top: 24px;">
                    <h3 style="margin: 0 0 16px 0; color: #333;">Informa√ß√µes do Sistema</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <div>
                            <strong>√öltima Atualiza√ß√£o:</strong><br>
                            <span id="last-backup-date">-</span>
                        </div>
                        <div>
                            <strong>Total de Registros:</strong><br>
                            <span id="total-records">-</span>
                        </div>
                        <div>
                            <strong>Tamanho dos Dados:</strong><br>
                            <span id="data-size">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Monitor Tab -->
        <div id="monitor-tab" class="tab-content">
            <div class="content-header">
                <h2 class="content-title">üìà Monitor do Sistema</h2>
            </div>
            <div style="padding: 24px;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 24px;">
                    <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; text-align: center;">
                        <h3 style="margin: 0 0 8px 0; color: #4a90e2; font-size: 2rem;" id="monitor-products">-</h3>
                        <p style="margin: 0; color: #666;">Produtos Ativos</p>
                    </div>
                    <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; text-align: center;">
                        <h3 style="margin: 0 0 8px 0; color: #5cb85c; font-size: 2rem;" id="monitor-categories">-</h3>
                        <p style="margin: 0; color: #666;">Categorias</p>
                    </div>
                    <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; text-align: center;">
                        <h3 style="margin: 0 0 8px 0; color: #f39c12; font-size: 2rem;" id="monitor-users">-</h3>
                        <p style="margin: 0; color: #666;">Usu√°rios Ativos</p>
                    </div>
                    <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; text-align: center;">
                        <h3 style="margin: 0 0 8px 0; color: #e74c3c; font-size: 2rem;" id="monitor-promotions">-</h3>
                        <p style="margin: 0; color: #666;">Promo√ß√µes Ativas</p>
                    </div>
                </div>
                
                <!-- System Status -->
                <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px;">
                    <h3 style="margin: 0 0 16px 0; color: #333;">Status do Sistema</h3>
                    <table class="data-table">
                        <tbody>
                            <tr>
                                <td><strong>Plataforma</strong></td>
                                <td>GitHub Pages</td>
                            </tr>
                            <tr>
                                <td><strong>Modo de Opera√ß√£o</strong></td>
                                <td>Somente Leitura (JSON Est√°tico)</td>
                            </tr>
                            <tr>
                                <td><strong>Autentica√ß√£o</strong></td>
                                <td>Local (SessionStorage)</td>
                            </tr>
                            <tr>
                                <td><strong>Armazenamento</strong></td>
                                <td>Arquivos JSON no GitHub</td>
                            </tr>
                            <tr>
                                <td><strong>Performance</strong></td>
                                <td><span style="color: #5cb85c;">‚úì √ìtima (CDN Global)</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Adicionar Produto</h3>
                <button class="close-btn" onclick="closeModal('product-modal')">&times;</button>
            </div>
            <form id="product-form">
                <div class="form-group">
                    <label class="form-label">Nome do Produto</label>
                    <input type="text" class="form-input" id="product-name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Categoria</label>
                    <select class="form-select" id="product-category" required>
                        <option value="">Selecione uma categoria</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Pre√ßo √† Vista (R$)</label>
                    <input type="number" class="form-input" id="product-price" step="0.01" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('product-modal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Category Modal -->
    <div id="category-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Adicionar Categoria</h3>
                <button class="close-btn" onclick="closeModal('category-modal')">&times;</button>
            </div>
            <form id="category-form">
                <div class="form-group">
                    <label class="form-label">Nome da Categoria</label>
                    <input type="text" class="form-input" id="category-name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Descri√ß√£o</label>
                    <input type="text" class="form-input" id="category-description">
                </div>
                <div class="form-group">
                    <label class="form-label">Cor</label>
                    <input type="color" class="form-input" id="category-color" value="#4a90e2">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('category-modal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Adicionar Usu√°rio</h3>
                <button class="close-btn" onclick="closeModal('user-modal')">&times;</button>
            </div>
            <form id="user-form">
                <div class="form-group">
                    <label class="form-label">Nome</label>
                    <input type="text" class="form-input" id="user-name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" id="user-username" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" class="form-input" id="user-password" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Fun√ß√£o</label>
                    <select class="form-select" id="user-role" required>
                        <option value="">Selecione uma fun√ß√£o</option>
                        <option value="admin">Administrador</option>
                        <option value="loja">Loja</option>
                        <option value="restaurante">Restaurante</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Multiplicador de Pre√ßo</label>
                    <input type="number" class="form-input" id="user-multiplier" step="0.01" value="1.00" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('user-modal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // GitHub Pages Admin Client
        class AdminClient {
            constructor() {
                this.baseUrl = window.location.origin + window.location.pathname.replace('/admin.html', '');
                this.data = {
                    products: [],
                    categories: [],
                    users: [],
                    priceSettings: [],
                    promotions: []
                };
            }

            async loadData(filename) {
                try {
                    const response = await fetch(`${this.baseUrl}/data/${filename}`);
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    return await response.json();
                } catch (error) {
                    console.error(`Erro ao carregar ${filename}:`, error);
                    return [];
                }
            }

            async init() {
                // Check authentication
                const userSession = sessionStorage.getItem('currentUser');
                if (!userSession) {
                    window.location.href = 'login.html';
                    return;
                }

                const user = JSON.parse(userSession);
                if (user.role !== 'admin') {
                    alert('Acesso negado. Apenas administradores podem acessar esta √°rea.');
                    window.location.href = 'login.html';
                    return;
                }

                await this.loadAllData();
                this.renderProducts();
                this.renderCategories();
                this.renderUsers();
                this.renderPriceSettings();
            }

            async loadAllData() {
                try {
                    const [products, categories, users, priceSettings, promotions] = await Promise.all([
                        this.loadData('products.json'),
                        this.loadData('categories.json'),
                        this.loadData('users.json'),
                        this.loadData('price_settings.json'),
                        this.loadData('promotions.json')
                    ]);

                    this.data.products = products || [];
                    this.data.categories = categories || [];
                    this.data.users = users || [];
                    this.data.priceSettings = priceSettings || [];
                    this.data.promotions = promotions || [];

                    console.log(`Dados carregados: ${this.data.products.length} produtos, ${this.data.categories.length} categorias, ${this.data.users.length} usu√°rios, ${this.data.priceSettings.length} tabelas de pre√ßo, ${this.data.promotions.length} promo√ß√µes`);
                } catch (error) {
                    console.error('Erro ao carregar dados:', error);
                }
            }

            renderProducts() {
                const loading = document.getElementById('produtos-loading');
                const content = document.getElementById('produtos-content');
                const table = document.getElementById('produtos-table');
                const empty = document.getElementById('produtos-empty');

                loading.style.display = 'none';
                content.style.display = 'block';

                if (this.data.products.length === 0) {
                    table.style.display = 'none';
                    empty.style.display = 'block';
                    return;
                }

                empty.style.display = 'none';
                table.innerHTML = '';

                this.data.products.forEach((product, index) => {
                    const row = table.insertRow();
                    const basePrice = product.priceAVista || product.basePrice || product.finalPrice || 0;
                    
                    row.innerHTML = `
                        <td><div class="product-image-cell">üì¶</div></td>
                        <td><strong>${product.name || 'Sem nome'}</strong><br><small>${product.category || 'Sem categoria'}</small></td>
                        <td class="price-cell">R$ ${basePrice.toFixed(2)}</td>
                        <td class="price-cell">R$ ${(basePrice * 1.1).toFixed(2)}</td>
                        <td class="price-cell">R$ ${(basePrice * 1.15).toFixed(2)}</td>
                        <td class="price-cell">R$ ${(basePrice * 1.2).toFixed(2)}</td>
                        <td class="price-cell">R$ ${(basePrice * 1.25).toFixed(2)}</td>
                        <td class="action-buttons-cell">
                            <button class="btn btn-edit btn-sm" onclick="editProduct(${index})">‚úèÔ∏è</button>
                            <button class="btn btn-delete btn-sm" onclick="deleteProduct(${index})">üóëÔ∏è</button>
                        </td>
                    `;
                });
            }

            renderCategories() {
                const loading = document.getElementById('categorias-loading');
                const content = document.getElementById('categorias-content');
                const table = document.getElementById('categorias-table');

                loading.style.display = 'none';
                content.style.display = 'block';
                table.innerHTML = '';

                this.data.categories.forEach((category, index) => {
                    const productCount = this.data.products.filter(p => p.category === category.name).length;
                    const row = table.insertRow();
                    
                    row.innerHTML = `
                        <td><strong>${category.name || 'Sem nome'}</strong></td>
                        <td>${category.description || 'Sem descri√ß√£o'}</td>
                        <td><span style="background: ${category.color || '#ccc'}; padding: 4px 8px; border-radius: 4px; color: white;">${category.color || 'N/A'}</span></td>
                        <td>${productCount} produtos</td>
                        <td class="action-buttons-cell">
                            <button class="btn btn-edit btn-sm" onclick="editCategory(${index})">‚úèÔ∏è</button>
                            <button class="btn btn-delete btn-sm" onclick="deleteCategory(${index})">üóëÔ∏è</button>
                        </td>
                    `;
                });

                // Update product category dropdown
                const categorySelect = document.getElementById('product-category');
                categorySelect.innerHTML = '<option value="">Selecione uma categoria</option>';
                this.data.categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.name;
                    option.textContent = category.name;
                    categorySelect.appendChild(option);
                });
            }

            renderUsers() {
                const loading = document.getElementById('usuarios-loading');
                const content = document.getElementById('usuarios-content');
                const table = document.getElementById('usuarios-table');

                loading.style.display = 'none';
                content.style.display = 'block';
                table.innerHTML = '';

                this.data.users.forEach((user, index) => {
                    const row = table.insertRow();
                    const isActive = user.active !== false;
                    
                    row.innerHTML = `
                        <td><strong>${user.name || 'Sem nome'}</strong></td>
                        <td>${user.username || 'Sem username'}</td>
                        <td>${user.role || 'Sem fun√ß√£o'}</td>
                        <td>${(user.priceMultiplier || 1.0).toFixed(2)}x</td>
                        <td><span style="background: ${isActive ? '#5cb85c' : '#e74c3c'}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">${isActive ? 'Ativo' : 'Inativo'}</span></td>
                        <td class="action-buttons-cell">
                            <button class="btn btn-edit btn-sm" onclick="editUser(${index})">‚úèÔ∏è</button>
                            <button class="btn btn-delete btn-sm" onclick="deleteUser(${index})">üóëÔ∏è</button>
                        </td>
                    `;
                });
            }

            // Note: In GitHub Pages, these would normally save to local storage
            // In a real implementation, you'd need a backend to persist changes
            saveData(type, data) {
                this.data[type] = data;
                localStorage.setItem(`moveisbonafe_${type}`, JSON.stringify(data));
                console.log(`${type} salvos localmente (GitHub Pages - somente leitura)`);
            }
        }

        // Global variables
        let adminClient;

        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        // Modal management
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function openProductModal(productIndex = null) {
            const modal = document.getElementById('product-modal');
            const title = document.querySelector('#product-modal .modal-title');
            
            if (productIndex !== null) {
                title.textContent = 'Editar Produto';
                const product = adminClient.data.products[productIndex];
                document.getElementById('product-name').value = product.name || '';
                document.getElementById('product-category').value = product.category || '';
                document.getElementById('product-price').value = product.priceAVista || product.basePrice || 0;
            } else {
                title.textContent = 'Adicionar Produto';
                document.getElementById('product-form').reset();
            }
            
            openModal('product-modal');
        }

        function openCategoryModal(categoryIndex = null) {
            const modal = document.getElementById('category-modal');
            const title = document.querySelector('#category-modal .modal-title');
            
            if (categoryIndex !== null) {
                title.textContent = 'Editar Categoria';
                const category = adminClient.data.categories[categoryIndex];
                document.getElementById('category-name').value = category.name || '';
                document.getElementById('category-description').value = category.description || '';
                document.getElementById('category-color').value = category.color || '#4a90e2';
            } else {
                title.textContent = 'Adicionar Categoria';
                document.getElementById('category-form').reset();
            }
            
            openModal('category-modal');
        }

        function openUserModal(userIndex = null) {
            const modal = document.getElementById('user-modal');
            const title = document.querySelector('#user-modal .modal-title');
            
            if (userIndex !== null) {
                title.textContent = 'Editar Usu√°rio';
                const user = adminClient.data.users[userIndex];
                document.getElementById('user-name').value = user.name || '';
                document.getElementById('user-username').value = user.username || '';
                document.getElementById('user-password').value = user.password || '';
                document.getElementById('user-role').value = user.role || '';
                document.getElementById('user-multiplier').value = user.priceMultiplier || 1.0;
            } else {
                title.textContent = 'Adicionar Usu√°rio';
                document.getElementById('user-form').reset();
                document.getElementById('user-multiplier').value = '1.00';
            }
            
            openModal('user-modal');
        }

        // CRUD operations (GitHub Pages limitation - read-only)
        function editProduct(index) {
            openProductModal(index);
        }

        function deleteProduct(index) {
            if (confirm('Tem certeza que deseja excluir este produto?')) {
                adminClient.data.products.splice(index, 1);
                adminClient.saveData('products', adminClient.data.products);
                adminClient.renderProducts();
            }
        }

        function editCategory(index) {
            openCategoryModal(index);
        }

        function deleteCategory(index) {
            if (confirm('Tem certeza que deseja excluir esta categoria?')) {
                adminClient.data.categories.splice(index, 1);
                adminClient.saveData('categories', adminClient.data.categories);
                adminClient.renderCategories();
            }
        }

        function editUser(index) {
            openUserModal(index);
        }

        function deleteUser(index) {
            if (confirm('Tem certeza que deseja excluir este usu√°rio?')) {
                adminClient.data.users.splice(index, 1);
                adminClient.saveData('users', adminClient.data.users);
                adminClient.renderUsers();
            }
        }

        function importExcel() {
            alert('Funcionalidade de importa√ß√£o Excel em desenvolvimento\n(GitHub Pages - limita√ß√µes de upload)');
        }

        function logout() {
            sessionStorage.removeItem('currentUser');
            window.location.href = 'login.html';
        }

        // Form submissions
        document.getElementById('product-form').addEventListener('submit', (e) => {
            e.preventDefault();
            // In GitHub Pages, this would save to localStorage
            alert('Produto salvo localmente\n(GitHub Pages - somente leitura)');
            closeModal('product-modal');
        });

        document.getElementById('category-form').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('Categoria salva localmente\n(GitHub Pages - somente leitura)');
            closeModal('category-modal');
        });

        document.getElementById('user-form').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('Usu√°rio salvo localmente\n(GitHub Pages - somente leitura)');
            closeModal('user-modal');
        });

        // Initialize application
        document.addEventListener('DOMContentLoaded', () => {
            adminClient = new AdminClient();
            adminClient.init().catch(error => {
                console.error('Erro na inicializa√ß√£o:', error);
            });
        });

        console.log('MoveisBonafe Admin Panel - GitHub Pages');
        console.log('Sistema: Somente leitura com localStorage para demonstra√ß√£o');
    </script>
</body>
</html>